"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{8831:(e,r,t)=>{t.d(r,{FB:()=>s,Ho:()=>i,KS:()=>d,SN:()=>c,VL:()=>a,lY:()=>u,p9:()=>b,rJ:()=>m,tz:()=>o,wz:()=>h,xh:()=>l});let n="http://localhost:4000",a=async e=>{try{let r=await fetch("".concat(n,"/messages/").concat(e),{credentials:"include"});if(!r.ok)throw Error("Failed to fetch messages");return r.json()}catch(e){return console.error("Error fetching messages:",e),[]}},s=async(e,r)=>{try{let t=await fetch("".concat(n,"/messages/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:r}),credentials:"include"});if(!t.ok)throw Error("Failed to set messages");return t.json()}catch(e){throw console.error("Error setting messages:",e),e}},o=async(e,r)=>{try{if(!(await fetch("".concat(n,"/parent/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({childId:e,parentId:r}),credentials:"include"})).ok)throw Error("Failed to set branch parent")}catch(e){throw console.error("Error setting branch parent:",e),e}},i=async e=>{try{let r=await fetch("".concat(n,"/parent/").concat(e),{credentials:"include"});if(!r.ok)throw Error("Failed to fetch branch parent");return r.json()}catch(e){throw console.error("Error fetching branch parent:",e),e}},c=async e=>{try{if(!(await fetch("".concat(n,"/branch/").concat(e),{method:"DELETE",credentials:"include"})).ok)throw Error("Failed to delete branch")}catch(e){throw console.error("Error deleting the branch:",e),e}},l=async(e,r)=>{try{if(!(await fetch("".concat(n,"/title/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:r}),credentials:"include"})).ok)throw Error("Failed to set branch title")}catch(e){throw console.error("Error setting branch title:",e),e}},d=async e=>{try{let r=await fetch("".concat(n,"/title/generate/").concat(e),{method:"POST",credentials:"include"});if(!r.ok)throw Error("Failed to generate title");let t=await r.json();return{title:t.updatedBranch.name,credits:t.remainingCredits}}catch(e){throw console.error("Error generating title:",e),e}},h=async()=>{try{let e=await fetch("".concat(n,"/api/user"),{credentials:"include"});if(!e.ok)throw Error("Failed to fetch user");return e.json()}catch(e){return console.error("Error fetching user:",e),null}},u=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"New Branch";try{if(!(await fetch("".concat(n,"/branch"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branchId:e,name:r}),credentials:"include"})).ok)throw Error("Failed to create branch")}catch(e){throw console.error("Error creating branch:",e),e}},b=async()=>{try{let e=await fetch("".concat(n,"/branches"),{credentials:"include"});if(!e.ok)throw Error("Failed to fetch branches");return e.json()}catch(e){return console.error("Error fetching branches:",e),[]}},m=async(e,r)=>new Promise((t,a)=>{fetch("".concat(n,"/api/llm"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e}),credentials:"include"}).then(e=>{var n;if(!e.ok)throw Error("Failed to fetch LLM response");let s=null==(n=e.body)?void 0:n.getReader(),o=new TextDecoder,i="";if(!s)throw Error("No reader available");(async()=>{try{for(;;){let{done:e,value:n}=await s.read();if(e)break;for(let e of o.decode(n,{stream:!0}).split("\n"))if(e.startsWith("data: "))try{let n=JSON.parse(e.slice(6));if("content"===n.type)i+=n.content,r(i);else if("complete"===n.type)return void t({content:i,credits:n.credits});else if("error"===n.type)return void a(Error(n.error))}catch(e){}}}catch(e){a(e)}})()}).catch(e=>{console.error("Error fetching LLM response:",e),a(e)})})},26402:(e,r,t)=>{t.d(r,{n:()=>n});let n=(0,t(94257).v)(e=>({isSidebarOpen:!0,toggleSidebar:()=>e(e=>({isSidebarOpen:!e.isSidebarOpen}))}))},28324:(e,r,t)=>{t.d(r,{V:()=>b});var n=t(68225),a=t(59845),s=t(40242);let o=a.forwardRef((e,r)=>{let{className:t,type:a,...o}=e;return(0,n.jsx)("input",{type:a,className:(0,s.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...o})});o.displayName="Input";var i=t(82869),c=t(35603),l=t(25701),d=t(4091),h=t(26402);function u(e){let{children:r}=e,{isSidebarOpen:t}=(0,h.n)();return(0,n.jsx)("div",{className:(0,s.cn)("fixed bottom-6 left-0 right-0 transition-all duration-300 ease-in-out",t?"left-64":"left-20"),children:r})}function b(e){let{message:r,setMessage:t,onSubmit:a,onBranchOut:s,deleteBranch:h}=e;return(0,n.jsx)(u,{children:(0,n.jsx)("div",{className:"max-w-2xl mx-auto px-4",children:(0,n.jsxs)("form",{onSubmit:a,className:"relative flex items-center bg-white/80 backdrop-blur-sm border border-zinc-200 rounded-full shadow-xl p-2 group transition-shadow duration-300 ease-in-out focus-within:ring-2 focus-within:ring-zinc-300",children:[(0,n.jsx)(o,{type:"text",className:"flex-1 bg-transparent border-none focus:ring-0 focus:outline-none focus-visible:ring-offset-0 focus-visible:ring-0 text-base placeholder:text-zinc-500",value:r,onChange:e=>t(e.target.value),placeholder:"Type your message..."}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(i.$,{type:"submit",variant:"ghost",size:"icon",className:"rounded-full h-10 w-10 text-zinc-600 hover:bg-zinc-100 hover:text-zinc-900",disabled:!r.trim(),children:(0,n.jsx)(c.A,{size:20})}),s&&(0,n.jsx)(i.$,{type:"button",variant:"ghost",size:"icon",className:"rounded-full h-10 w-10 text-zinc-600 hover:bg-zinc-100 hover:text-zinc-900",onClick:s,children:(0,n.jsx)(l.A,{size:20})}),h&&(0,n.jsx)(i.$,{type:"button",variant:"ghost",size:"icon",className:"rounded-full h-10 w-10 text-red-500 hover:bg-red-100 hover:text-red-600",onClick:h,children:(0,n.jsx)(d.A,{size:20})})]})]})})})}},33892:(e,r,t)=>{t.d(r,{P:()=>o});var n=t(94257),a=t(97433),s=t(8831);let o=(0,n.v)()((0,a.Zr)((e,r)=>({messagesByBranch:{},branchParents:{},branchTitles:{},credits:0,user:null,getMessagesForBranch:async r=>{let t=await (0,s.VL)(r);return e(e=>({messagesByBranch:{...e.messagesByBranch,[r]:t}})),t},addMessageToBranch:async(r,t)=>{let n=await (0,s.FB)(r,t);return e(e=>({messagesByBranch:{...e.messagesByBranch,[r]:n}})),n},setBranchParent:async(r,t)=>{await (0,s.tz)(r,t),e(e=>({branchParents:{...e.branchParents,[r]:t}}))},getBranchParent:async r=>{let t=await (0,s.Ho)(r);return t&&e(e=>({branchParents:{...e.branchParents,[r]:t.id}})),(null==t?void 0:t.id)||null},setBranchTitle:async(r,t)=>{await (0,s.xh)(r,t),e(e=>({branchTitles:{...e.branchTitles,[r]:t}}))},getBranchTitle:e=>r().branchTitles[e]||null,deleteBranch:async r=>{await (0,s.SN)(r),e(e=>{let{[r]:t,...n}=e.messagesByBranch,{[r]:a,...s}=e.branchParents,{[r]:o,...i}=e.branchTitles;return{messagesByBranch:n,branchParents:s,branchTitles:i}})},createBranch:async(e,r)=>{await (0,s.lY)(e,r)},loadBranches:async()=>{let r=await (0,s.p9)();e(()=>{let e={},t={},n={};return r.forEach(r=>{var a;e[r.id]=null!=(a=r.messages)?a:[],r.parentId&&(t[r.id]=r.parentId),n[r.id]=r.name}),{messagesByBranch:e,branchParents:t,branchTitles:n}})},setCredits:r=>{e(()=>({credits:r}))},loadUser:async()=>{let r=await (0,s.wz)();e(()=>({user:r,credits:(null==r?void 0:r.credits)||0}))}}),{name:"chat-storage",skipHydration:!0}))},40242:(e,r,t)=>{t.d(r,{cn:()=>s});var n=t(54407),a=t(86955);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.QP)((0,n.$)(r))}},44823:(e,r,t)=>{t.d(r,{c:()=>h});var n=t(68225),a=t(59845),s=t(64356),o=t(85084),i=t(34319),c=t(17097),l=t(36098),d=t(74532);let h=e=>{let{message:r}=e,[t,h]=(0,a.useState)(!1),[u,b]=(0,a.useState)(null),m=(e,r)=>{navigator.clipboard.writeText(e),"number"==typeof r?(b(r),setTimeout(()=>b(null),2e3)):(h(!0),setTimeout(()=>h(!1),2e3))};return(0,n.jsxs)("div",{className:"flex items-end gap-3 group relative ".concat("user"===r.role?"justify-end":"justify-start"),children:["assistant"===r.role&&(0,n.jsx)("div",{className:"w-2 h-2 mb-4 rounded-full bg-zinc-300 flex-shrink-0"}),(0,n.jsx)("div",{className:"flex flex-col ".concat("user"===r.role?"max-w-[60%] items-end":"items-start max-w-[calc(100%-2rem)]"),children:(0,n.jsxs)("div",{className:"\n                        relative py-3 text-base leading-loose break-words\n                        ".concat("user"===r.role?"px-5 bg-zinc-900 text-zinc-50 rounded-md shadow-[2px_2px_0px_0px_rgba(0,0,0,0.08)]":"px-5 bg-zinc-50 border-l-2 border-zinc-200 shadow-[2px_2px_0px_0px_rgba(0,0,0,0.08)] rounded-md","\n                    "),children:[(0,n.jsx)("button",{onClick:()=>m(r.content),className:"absolute top-2 right-2 p-1.5 rounded-md opacity-0 group-hover:opacity-100 transition-opacity ".concat("user"===r.role?"bg-zinc-700/50 text-zinc-300":"bg-zinc-200/50 text-zinc-600"),children:t?(0,n.jsx)(l.A,{size:14}):(0,n.jsx)(d.A,{size:14})}),(0,n.jsx)("div",{className:"pr-8 overflow-hidden",children:(0,n.jsx)(s.oz,{remarkPlugins:[c.A],components:{code(e){var r,t,a;let{node:s,className:c,children:h}=e,b=/language-(\w+)/.exec(c||""),f=String(h).replace(/\n$/,""),g=null!=(a=null==s||null==(t=s.position)||null==(r=t.start)?void 0:r.offset)?a:Math.random();return b?(0,n.jsxs)("div",{className:"relative group/code my-4 bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:[(0,n.jsxs)("div",{className:"absolute top-3 right-3 z-10 flex items-center gap-2 opacity-0 group-hover/code:opacity-100 transition-opacity duration-300",children:[(0,n.jsx)("span",{className:"text-xs text-zinc-400 select-none",children:b[1]}),(0,n.jsx)("button",{onClick:()=>m(f,g),className:"p-1 rounded-md bg-zinc-800 text-zinc-300 hover:bg-zinc-700 hover:text-zinc-50",children:u===g?(0,n.jsx)(l.A,{size:14,className:"text-emerald-400"}):(0,n.jsx)(d.A,{size:14})})]}),(0,n.jsx)(o.A,{style:i.A,language:b[1],PreTag:"div",customStyle:{padding:"1rem",backgroundColor:"transparent",overflow:"auto"},children:f})]}):(0,n.jsx)("code",{className:"bg-zinc-200 text-zinc-800 px-1 py-0.5 rounded-md break-all",children:h})},p:e=>{let{children:r}=e;return(0,n.jsx)("p",{className:"mb-2 last:mb-0 break-words",children:r})},ul:e=>{let{children:r}=e;return(0,n.jsx)("ul",{className:"list-disc list-inside mb-2 last:mb-0 break-words",children:r})},ol:e=>{let{children:r}=e;return(0,n.jsx)("ol",{className:"list-decimal list-inside mb-2 last:mb-0 break-words",children:r})},li:e=>{let{children:r}=e;return(0,n.jsx)("li",{className:"mb-1 break-words",children:r})},h1:e=>{let{children:r}=e;return(0,n.jsx)("h1",{className:"text-xl font-bold mb-2 break-words",children:r})},h2:e=>{let{children:r}=e;return(0,n.jsx)("h2",{className:"text-lg font-semibold mb-2 break-words",children:r})},h3:e=>{let{children:r}=e;return(0,n.jsx)("h3",{className:"text-md font-semibold mb-2 break-words",children:r})},blockquote:e=>{let{children:r}=e;return(0,n.jsx)("blockquote",{className:"border-l-4 border-zinc-300 pl-4 italic mb-2 break-words",children:r})}},children:r.content})})]})}),"user"===r.role&&(0,n.jsx)("div",{className:"w-2 h-2 mb-4 rounded-full bg-zinc-400 flex-shrink-0"})]})}},82869:(e,r,t)=>{t.d(r,{$:()=>l});var n=t(68225),a=t(59845),s=t(5551),o=t(51151),i=t(40242);let c=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef((e,r)=>{let{className:t,variant:a,size:o,asChild:l=!1,...d}=e,h=l?s.DX:"button";return(0,n.jsx)(h,{className:(0,i.cn)(c({variant:a,size:o,className:t})),ref:r,...d})});l.displayName="Button"}}]);